<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="635px" preserveAspectRatio="none" style="width:1689px;height:635px;background:#FFFFFF;" version="1.1" viewBox="0 0 1689 635" width="1689px" zoomAndPan="magnify"><defs/><g><!--MD5=[575530b3b246506db8b75a4ad5e907c4]
class BaseNormalizer--><g id="elem_BaseNormalizer"><rect codeLine="33" fill="#FFFFFF" height="146.9297" id="BaseNormalizer" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="367" x="1311.5" y="89.51"/><ellipse cx="1326.5" cy="105.51" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1326.3633,100.8581 L1325.2095,105.9299 L1327.5254,105.9299 Z M1324.8691,98.6169 L1327.8657,98.6169 L1331.2109,111.01 L1328.7622,111.01 L1327.9985,107.947 L1324.7197,107.947 L1323.9727,111.01 L1321.5239,111.01 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="107" x="1340.5" y="110.801">BaseNormalizer</text><rect fill="#FFFFFF" height="16.1328" style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" width="226" x="1455.5" y="86.51"/><text fill="#000000" font-family="Computer Modern" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="224" x="1456.5" y="99.1116">T extends torch.Tensor | npt.ArrayLike</text><line style="stroke:#000000;stroke-width:0.5;" x1="1312.5" x2="1677.5" y1="121.51" y2="121.51"/><line style="stroke:#000000;stroke-width:0.5;" x1="1312.5" x2="1677.5" y1="129.51" y2="129.51"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="309" x="1317.5" y="147.0452">save(instance: BaseNormalizer, filename: str):</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="263" x="1317.5" y="163.5334">load(filename: str) -&gt; BaseNormalizer:</text><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="138" x="1317.5" y="180.0217">fit(data: T) -&gt; None:</text><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="126" x="1317.5" y="196.51">is_fitted() -&gt; bool:</text><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="166" x="1317.5" y="212.9983">normalize(data: T) -&gt; T:</text><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="180" x="1317.5" y="229.4866">renormalize(data: T) -&gt; T:</text></g><!--MD5=[8e7b4fdb525ee12c3e8d624d9db4aaa7]
class Evaluator--><g id="elem_Evaluator"><rect codeLine="41" fill="#FFFFFF" height="196.3945" id="Evaluator" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="520" x="733" y="65.01"/><ellipse cx="956.75" cy="81.01" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M959.2231,87.1531 Q958.6421,87.4519 958.0029,87.6013 Q957.3638,87.7507 956.6582,87.7507 Q954.1514,87.7507 952.8315,86.0989 Q951.5117,84.447 951.5117,81.3259 Q951.5117,78.1965 952.8315,76.5447 Q954.1514,74.8928 956.6582,74.8928 Q957.3638,74.8928 958.0112,75.0422 Q958.6587,75.1916 959.2231,75.4905 L959.2231,78.2131 Q958.5923,77.6321 957.9988,77.3623 Q957.4053,77.0925 956.7744,77.0925 Q955.4297,77.0925 954.7449,78.1592 Q954.0601,79.2258 954.0601,81.3259 Q954.0601,83.4177 954.7449,84.4844 Q955.4297,85.551 956.7744,85.551 Q957.4053,85.551 957.9988,85.2812 Q958.5923,85.0115 959.2231,84.4304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="64" x="977.25" y="86.301">Evaluator</text><line style="stroke:#000000;stroke-width:0.5;" x1="734" x2="1252" y1="97.01" y2="97.01"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="302" x="739" y="114.5452">model: torch.jit.ScriptModule | torch.Module</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="148" x="739" y="131.0334">latent_vector_size: int</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="186" x="739" y="147.5217">feature_labels: list[Feature]</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="190" x="739" y="164.01">normalizer: BaseNormalizer</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="135" x="739" y="180.4983">device: torch.Device</text><line style="stroke:#000000;stroke-width:0.5;" x1="734" x2="1252" y1="187.4514" y2="187.4514"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="428" x="739" y="204.9866">eval(self, z: torch.tensor, c: Optional[torch.Tensor]) -&gt; Tensor:</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="383" x="739" y="221.4748">generate(self, start: datetime, end: datetime) -&gt; Tensor:</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="508" x="739" y="237.9631">generate_dataframe(self, start: datetime, end: datetime) -&gt; pd.DataFrame:</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="346" x="739" y="254.4514">load(path: Path, device: torch.device) -&gt; Evaluator:</text></g><!--MD5=[9ce1b08c9589625f5dbaa36e7b35b26e]
class BaseTrainer--><g id="elem_BaseTrainer"><rect codeLine="9" fill="#FFFFFF" height="146.9297" id="BaseTrainer" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="215" x="482.5" y="89.51"/><ellipse cx="545.25" cy="105.51" fill="#A9DCDF" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M545.1133,100.8581 L543.9595,105.9299 L546.2754,105.9299 Z M543.6191,98.6169 L546.6157,98.6169 L549.9609,111.01 L547.5122,111.01 L546.7485,107.947 L543.4697,107.947 L542.7227,111.01 L540.2739,111.01 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="81" x="565.75" y="110.801">BaseTrainer</text><line style="stroke:#000000;stroke-width:0.5;" x1="483.5" x2="696.5" y1="121.51" y2="121.51"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="154" x="488.5" y="139.0452">generator: TrainModel</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="177" x="488.5" y="155.5334">discriminator: TrainModel</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="167" x="488.5" y="172.0217">data_holder: DataHolder</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="189" x="488.5" y="188.51">device: torch.Device = "cpu"</text><line style="stroke:#000000;stroke-width:0.5;" x1="483.5" x2="696.5" y1="195.4631" y2="195.4631"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="161" x="488.5" y="212.9983">train(epochs: int): None</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" text-decoration="underline" textLength="203" x="488.5" y="229.4866">save_model(path: Path): None</text></g><!--MD5=[df0e54ec284d684608a310a2df20297c]
class DataHolder--><g id="elem_DataHolder"><rect codeLine="18" fill="#FFFFFF" height="130.4414" id="DataHolder" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="396" x="1180" y="348.51"/><ellipse cx="1335.25" cy="364.51" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M1337.7231,370.6531 Q1337.1421,370.9519 1336.5029,371.1013 Q1335.8638,371.2507 1335.1582,371.2507 Q1332.6514,371.2507 1331.3315,369.5989 Q1330.0117,367.947 1330.0117,364.8259 Q1330.0117,361.6965 1331.3315,360.0447 Q1332.6514,358.3928 1335.1582,358.3928 Q1335.8638,358.3928 1336.5112,358.5422 Q1337.1587,358.6916 1337.7231,358.9905 L1337.7231,361.7131 Q1337.0923,361.1321 1336.4988,360.8623 Q1335.9053,360.5925 1335.2744,360.5925 Q1333.9297,360.5925 1333.2449,361.6592 Q1332.5601,362.7258 1332.5601,364.8259 Q1332.5601,366.9177 1333.2449,367.9844 Q1333.9297,369.051 1335.2744,369.051 Q1335.9053,369.051 1336.4988,368.7812 Q1337.0923,368.5115 1337.7231,367.9304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="77" x="1355.75" y="369.801">DataHolder</text><line style="stroke:#000000;stroke-width:0.5;" x1="1181" x2="1575" y1="380.51" y2="380.51"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="133" x="1186" y="398.0452">data: npt.ArrayLike,</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="236" x="1186" y="414.5334">data_labels: Optional[list[Feature]]</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="205" x="1186" y="431.0217">dates: Optional[npt.ArrayLike]</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="240" x="1186" y="447.51">conditions: Optional[npt.ArrayLike]</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="384" x="1186" y="463.9983">normalizer_constructor: Optional[type[BaseNormalizer]]</text><line style="stroke:#000000;stroke-width:0.5;" x1="1181" x2="1575" y1="470.9514" y2="470.9514"/></g><!--MD5=[627246f29547be4ae1388c8839f96f8c]
class TrainModel--><g id="elem_TrainModel"><rect codeLine="26" fill="#FFFFFF" height="97.4648" id="TrainModel" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="264" x="765" y="365.01"/><ellipse cx="853.75" cy="381.01" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M856.2231,387.1531 Q855.6421,387.4519 855.0029,387.6013 Q854.3638,387.7507 853.6582,387.7507 Q851.1514,387.7507 849.8315,386.0989 Q848.5117,384.447 848.5117,381.3259 Q848.5117,378.1965 849.8315,376.5447 Q851.1514,374.8928 853.6582,374.8928 Q854.3638,374.8928 855.0112,375.0422 Q855.6587,375.1916 856.2231,375.4905 L856.2231,378.2131 Q855.5923,377.6321 854.9988,377.3623 Q854.4053,377.0925 853.7744,377.0925 Q852.4297,377.0925 851.7449,378.1592 Q851.0601,379.2258 851.0601,381.3259 Q851.0601,383.4177 851.7449,384.4844 Q852.4297,385.551 853.7744,385.551 Q854.4053,385.551 854.9988,385.2812 Q855.5923,385.0115 856.2231,384.4304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="78" x="874.25" y="386.301">TrainModel</text><line style="stroke:#000000;stroke-width:0.5;" x1="766" x2="1028" y1="397.01" y2="397.01"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="142" x="771" y="414.5452">model: torch.Module</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="182" x="771" y="431.0334">optimizer: torch.Optimizer</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="252" x="771" y="447.5217">scheduler: Optional[torch.Scheduler]</text><line style="stroke:#000000;stroke-width:0.5;" x1="766" x2="1028" y1="454.4748" y2="454.4748"/></g><!--MD5=[1c6360a4022f9be322d5f7debc785032]
class VanillaGANTrainer--><g id="elem_VanillaGANTrainer"><rect codeLine="54" fill="#FFFFFF" height="80.9766" id="VanillaGANTrainer" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="158" x="7" y="373.01"/><ellipse cx="22" cy="389.01" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M24.4731,395.1531 Q23.8921,395.4519 23.2529,395.6013 Q22.6138,395.7507 21.9082,395.7507 Q19.4014,395.7507 18.0815,394.0989 Q16.7617,392.447 16.7617,389.3259 Q16.7617,386.1965 18.0815,384.5447 Q19.4014,382.8928 21.9082,382.8928 Q22.6138,382.8928 23.2612,383.0422 Q23.9087,383.1916 24.4731,383.4905 L24.4731,386.2131 Q23.8423,385.6321 23.2488,385.3623 Q22.6553,385.0925 22.0244,385.0925 Q20.6797,385.0925 19.9949,386.1592 Q19.3101,387.2258 19.3101,389.3259 Q19.3101,391.4177 19.9949,392.4844 Q20.6797,393.551 22.0244,393.551 Q22.6553,393.551 23.2488,393.2812 Q23.8423,393.0115 24.4731,392.4304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="126" x="36" y="394.301">VanillaGANTrainer</text><line style="stroke:#000000;stroke-width:0.5;" x1="8" x2="164" y1="405.01" y2="405.01"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="12" x="13" y="422.5452">...</text><line style="stroke:#000000;stroke-width:0.5;" x1="8" x2="164" y1="429.4983" y2="429.4983"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="12" x="13" y="447.0334">...</text></g><!--MD5=[827a031ac1b8ae6f29bdbbcd505367fe]
class CGANTrainer--><g id="elem_CGANTrainer"><rect codeLine="58" fill="#FFFFFF" height="146.9297" id="CGANTrainer" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="280" x="450" y="340.01"/><ellipse cx="540.75" cy="356.01" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M543.2231,362.1531 Q542.6421,362.4519 542.0029,362.6013 Q541.3638,362.7507 540.6582,362.7507 Q538.1514,362.7507 536.8315,361.0989 Q535.5117,359.447 535.5117,356.3259 Q535.5117,353.1965 536.8315,351.5447 Q538.1514,349.8928 540.6582,349.8928 Q541.3638,349.8928 542.0112,350.0422 Q542.6587,350.1916 543.2231,350.4905 L543.2231,353.2131 Q542.5923,352.6321 541.9988,352.3623 Q541.4053,352.0925 540.7744,352.0925 Q539.4297,352.0925 538.7449,353.1592 Q538.0601,354.2258 538.0601,356.3259 Q538.0601,358.4177 538.7449,359.4844 Q539.4297,360.551 540.7744,360.551 Q541.4053,360.551 541.9988,360.2812 Q542.5923,360.0115 543.2231,359.4304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="90" x="561.25" y="361.301">CGANTrainer</text><line style="stroke:#000000;stroke-width:0.5;" x1="451" x2="729" y1="372.01" y2="372.01"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="227" x="456" y="389.5452">noise_generator: NoiseGenerator</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="215" x="456" y="406.0334">batch_reshaper: BatchReshaper</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="234" x="456" y="422.5217">callback_options: CallbackOptions</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="192" x="456" y="439.01">latex_options: LatexOptions</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="200" x="456" y="455.4983">dataloader: torch.DataLoader</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="268" x="456" y="471.9866">criterion: torch.Module  = nn.BCELoss()</text><line style="stroke:#000000;stroke-width:0.5;" x1="451" x2="729" y1="478.9397" y2="478.9397"/></g><!--MD5=[9d7108122bfe6f6100bd5b696e184360]
class TrainParameters--><g id="elem_TrainParameters"><rect codeLine="66" fill="#FFFFFF" height="113.9531" id="TrainParameters" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="191" x="223.5" y="356.51"/><ellipse cx="259.2" cy="372.51" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M261.6731,378.6531 Q261.0921,378.9519 260.4529,379.1013 Q259.8138,379.2507 259.1082,379.2507 Q256.6014,379.2507 255.2815,377.5989 Q253.9617,375.947 253.9617,372.8259 Q253.9617,369.6965 255.2815,368.0447 Q256.6014,366.3928 259.1082,366.3928 Q259.8138,366.3928 260.4612,366.5422 Q261.1087,366.6916 261.6731,366.9905 L261.6731,369.7131 Q261.0423,369.1321 260.4488,368.8623 Q259.8553,368.5925 259.2244,368.5925 Q257.8797,368.5925 257.1949,369.6592 Q256.5101,370.7258 256.5101,372.8259 Q256.5101,374.9177 257.1949,375.9844 Q257.8797,377.051 259.2244,377.051 Q259.8553,377.051 260.4488,376.7812 Q261.0423,376.5115 261.6731,375.9304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="113" x="277.8" y="377.801">TrainParameters</text><line style="stroke:#000000;stroke-width:0.5;" x1="224.5" x2="413.5" y1="388.51" y2="388.51"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="148" x="229.5" y="406.0452">latent_vector_size: int</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="119" x="229.5" y="422.5334">sequence_len: int</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="98" x="229.5" y="439.0217">batch_size: int</text><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="179" x="229.5" y="455.51">features_len: Optional[int]</text><line style="stroke:#000000;stroke-width:0.5;" x1="224.5" x2="413.5" y1="462.4631" y2="462.4631"/></g><!--MD5=[41f4993961d4e7f275ed5a6158011e17]
class ConditionalTrainParameters--><g id="elem_ConditionalTrainParameters"><rect codeLine="72" fill="#FFFFFF" height="64.4883" id="ConditionalTrainParameters" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="225" x="341.5" y="564.01"/><ellipse cx="356.5" cy="580.01" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1.0;"/><path d="M358.9731,586.1531 Q358.3921,586.4519 357.7529,586.6013 Q357.1138,586.7507 356.4082,586.7507 Q353.9014,586.7507 352.5815,585.0989 Q351.2617,583.447 351.2617,580.3259 Q351.2617,577.1965 352.5815,575.5447 Q353.9014,573.8928 356.4082,573.8928 Q357.1138,573.8928 357.7612,574.0422 Q358.4087,574.1916 358.9731,574.4905 L358.9731,577.2131 Q358.3423,576.6321 357.7488,576.3623 Q357.1553,576.0925 356.5244,576.0925 Q355.1797,576.0925 354.4949,577.1592 Q353.8101,578.2258 353.8101,580.3259 Q353.8101,582.4177 354.4949,583.4844 Q355.1797,584.551 356.5244,584.551 Q357.1553,584.551 357.7488,584.2812 Q358.3423,584.0115 358.9731,583.4304 Z " fill="#000000"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="193" x="370.5" y="585.301">ConditionalTrainParameters</text><line style="stroke:#000000;stroke-width:0.5;" x1="342.5" x2="565.5" y1="596.01" y2="596.01"/><text fill="#000000" font-family="Computer Modern" font-size="14" lengthAdjust="spacing" textLength="137" x="347.5" y="613.5452">embedding_dim: int</text><line style="stroke:#000000;stroke-width:0.5;" x1="342.5" x2="565.5" y1="620.4983" y2="620.4983"/></g><!--MD5=[86f7d4020ab513d21d26628f6e7de003]
reverse link BaseTrainer to VanillaGANTrainer--><g id="link_BaseTrainer_VanillaGANTrainer"><path codeLine="80" d="M463.71,217.56 C387.95,250.75 290.26,295.43 206,340.01 C186.96,350.08 166.74,361.86 148.44,372.95 " fill="none" id="BaseTrainer-backto-VanillaGANTrainer" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="none" points="461.35,210.95,482.48,209.38,466.95,223.79,461.35,210.95" style="stroke:#000000;stroke-width:1.0;"/></g><!--MD5=[83f5af90be4f41a4dfae33f5365988dc]
reverse link BaseTrainer to CGANTrainer--><g id="link_BaseTrainer_CGANTrainer"><path codeLine="81" d="M590,256.58 C590,284.09 590,313.83 590,339.88 " fill="none" id="BaseTrainer-backto-CGANTrainer" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="none" points="583,256.55,590,236.55,597,256.55,583,256.55" style="stroke:#000000;stroke-width:1.0;"/></g><!--MD5=[d2ace6cdee20f9bb0356d0e7e46a6cbc]
reverse link BaseTrainer to TrainModel--><g id="link_BaseTrainer_TrainModel"><path codeLine="82" d="M672.06,245.47 C686.7,259.05 702.05,272.7 717,285.01 C751.15,313.12 791.12,341.82 824.72,364.85 " fill="none" id="BaseTrainer-backto-TrainModel" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="662.55,236.58,664.1999,243.5998,671.3143,244.7768,669.6644,237.7569,662.55,236.58" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="29" x="746" y="306.5784">uses</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="663.179" y="256.8935">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="805.5164" y="354.1585">2</text></g><!--MD5=[c6f8d87067dc12a8ffee538e004fa5a2]
reverse link BaseTrainer to DataHolder--><g id="link_BaseTrainer_DataHolder"><path codeLine="83" d="M660.11,245.72 C677.19,261.1 696.5,275.36 717,285.01 C744.13,297.78 754.34,288.59 784,293.01 C916.79,312.79 1064.81,342.54 1179.87,367.42 " fill="none" id="BaseTrainer-backto-DataHolder" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="650.32,236.57,651.9752,243.5886,659.0905,244.7602,657.4353,237.7416,650.32,236.57" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="22" x="882" y="306.5784">use</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="649.7833" y="256.8825">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="1163.9743" y="362.8924">1</text></g><!--MD5=[58a62173f17222ae38dae574d30fd96e]
reverse link TrainParameters to ConditionalTrainParameters--><g id="link_TrainParameters_ConditionalTrainParameters"><path codeLine="84" d="M373.17,486.94 C393.21,513.73 414.87,542.7 430.73,563.89 " fill="none" id="TrainParameters-backto-ConditionalTrainParameters" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="none" points="367.35,490.84,360.97,470.63,378.56,482.46,367.35,490.84" style="stroke:#000000;stroke-width:1.0;"/></g><!--MD5=[eaab112010f0d04b4af8f06725216455]
reverse link VanillaGANTrainer to TrainParameters--><g id="link_VanillaGANTrainer_TrainParameters"><path codeLine="85" d="M178.59,413.51 C193.35,413.51 208.65,413.51 223.49,413.51 " fill="none" id="VanillaGANTrainer-backto-TrainParameters" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="165.21,413.51,171.21,417.51,177.21,413.51,171.21,409.51,165.21,413.51" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="22" x="183.25" y="407.0784">use</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="173.0456" y="410.3794">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="207.5603" y="410.4949">1</text></g><!--MD5=[3c1811f84b28dff22517300cd0fda4c6]
reverse link CGANTrainer to ConditionalTrainParameters--><g id="link_CGANTrainer_ConditionalTrainParameters"><path codeLine="86" d="M527.44,497.54 C509.7,521.08 491.46,545.29 477.6,563.69 " fill="none" id="CGANTrainer-backto-ConditionalTrainParameters" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="535.27,487.15,528.4642,489.5336,528.0468,496.7326,534.8526,494.349,535.27,487.15" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="22" x="511" y="530.5784">use</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="523.7676" y="507.4702">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="473.6425" y="553.0272">1</text></g><!--MD5=[c732dbe34932c94a6084eef573e24ddd]
reverse link Evaluator to BaseNormalizer--><g id="link_Evaluator_BaseNormalizer"><path codeLine="87" d="M1266.49,163.01 C1281.6,163.01 1296.61,163.01 1311.28,163.01 " fill="none" id="Evaluator-backto-BaseNormalizer" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1253.19,163.01,1259.19,167.01,1265.19,163.01,1259.19,159.01,1253.19,163.01" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="22" x="1271.25" y="156.5784">use</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="1261.0035" y="160.3545">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="1295.3606" y="160.27">1</text></g><!--MD5=[e939bd6ed9e8c15d83e7434a4d1fbb59]
reverse link DataHolder to BaseNormalizer--><g id="link_DataHolder_BaseNormalizer"><path codeLine="88" d="M1413.82,336.42 C1428.78,304.66 1446.07,267.93 1460.84,236.55 " fill="none" id="DataHolder-backto-BaseNormalizer" style="stroke:#000000;stroke-width:1.0;"/><polygon fill="#000000" points="1408.22,348.33,1414.3967,344.6086,1413.3372,337.4758,1407.1605,341.1972,1408.22,348.33" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="22" x="1433" y="306.5784">use</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="6" x="1405.1972" y="337.9418">*</text><text fill="#000000" font-family="Computer Modern" font-size="13" lengthAdjust="spacing" textLength="8" x="1449.0836" y="257.1145">1</text></g><!--MD5=[48a108f62d176c89f58cbbb6de4f43dc]
link BaseNormalizer to BaseTrainer--><!--MD5=[820086be6caba5c260a2afc025062817]
@startuml
top to bottom direction
skinparam defaultFontName Computer Modern
skinparam class {
    BackgroundColor White
    ArrowColor Black
    BorderColor Black
}

abstract class BaseTrainer {
    generator: TrainModel
    discriminator: TrainModel
    data_holder: DataHolder
    device: torch.Device = "cpu"
    train(epochs: int): None
    {static} save_model(path: Path): None
}

class DataHolder {
    data: npt.ArrayLike,
    data_labels: Optional[list[Feature]]
    dates: Optional[npt.ArrayLike]
    conditions: Optional[npt.ArrayLike]
    normalizer_constructor: Optional[type[BaseNormalizer]]
}

class TrainModel {
    model: torch.Module
    optimizer: torch.Optimizer
    scheduler: Optional[torch.Scheduler]
}

together {
abstract class BaseNormalizer<T extends torch.Tensor | npt.ArrayLike> {
    {static} save(instance: BaseNormalizer, filename: str):
    {static} load(filename: str) -> BaseNormalizer:
    {abstract} fit(data: T) -> None:
    {abstract} is_fitted() -> bool:
    {abstract} normalize(data: T) -> T:
    {abstract} renormalize(data: T) -> T:
}
class Evaluator {
    model: torch.jit.ScriptModule | torch.Module
    latent_vector_size: int
    feature_labels: list[Feature]
    normalizer: BaseNormalizer
    device: torch.Device
    eval(self, z: torch.tensor, c: Optional[torch.Tensor]) -> Tensor:
    generate(self, start: datetime, end: datetime) -> Tensor:
    generate_dataframe(self, start: datetime, end: datetime) -> pd.DataFrame:
    {static} load(path: Path, device: torch.device) -> Evaluator:
}
}

class VanillaGANTrainer {
    ...
    {method} ...
}
class CGANTrainer {
    noise_generator: NoiseGenerator
    batch_reshaper: BatchReshaper
    callback_options: CallbackOptions
    latex_options: LatexOptions
    dataloader: torch.DataLoader
    {field} criterion: torch.Module  = nn.BCELoss()
}
class TrainParameters {
    latent_vector_size: int 
    sequence_len: int 
    batch_size: int 
    features_len: Optional[int]
}
class ConditionalTrainParameters {
    embedding_dim: int
}





BaseTrainer <|- - VanillaGANTrainer
BaseTrainer <|- - CGANTrainer
BaseTrainer "*" *- - "2" TrainModel : uses
BaseTrainer "*" *- - "1" DataHolder : use
TrainParameters <|- - ConditionalTrainParameters 
VanillaGANTrainer "*" *- "1" TrainParameters : use
CGANTrainer "*" *- "1" ConditionalTrainParameters : use
Evaluator "*" *- "1" BaseNormalizer : use
DataHolder "*" *- "1" BaseNormalizer : use
BaseNormalizer -[hidden] BaseTrainer
@enduml

PlantUML version 1.2022.3(Tue Mar 29 18:10:57 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>